<외부 api를 통해 약국 찾기 서비스>
----------------서비스 소개---------------------------

외부 API, 공공데이터를 활용해 지역을 검색하면 가까운 약국 3곳을 찾아주는
서비스를 개발한다.
![image](https://github.com/Choi-InHo/kakaoApi/assets/146165158/b925f0e5-1676-45c7-b598-71b0504de5fd)

![image](https://github.com/Choi-InHo/kakaoApi/assets/146165158/6d809988-3517-494a-9f81-be5056a3f379)

![image](https://github.com/Choi-InHo/kakaoApi/assets/146165158/2a983589-7344-40c0-a78e-fccf72847879)



----------------기술 스택---------------------------
JDK 11
Spring Boot 2.6.7
Spring Data JPA
Gradle
Handlebars
Lombok
Github
Docker
AWS EC2
Redis
MariaDB
Spock
Testcontainers


----------------학습한 내용 정리 및 배포 관련 내용-----------------------

도커란?
-컨테이너를 사용하여 응용프로그램을 더 쉽게 만들고, 배포하고 실행할 수 있도록 설계된 도구
-어플리케이션 환경에 구야 받지 않고 손쉽게 배포 관리를 할 수 있게 해준다.

spring profile는 어플리케이션 설정을 특정 환경에서만 적용되게 하거나 환경별로 다르게 적용될 때 사용
(application.yml)

docker compose:
멀티 컨테이너 도커 어플리케이션을 정의하고 실행하는 도구
여러개의 도커 컨테이너로부터 이루어진 서비스를 구축 및 네트워크 연결, 실행 순서를 자동으로 관리

—————————————————————————————————————————————
테스트 코드의 중요성
-테스트 코드는 기능에 대한 불확실성을 감소시킬 수 있으며, 개발자가 만든 기능을 안전하게 보호해준다.
-테스트 코드 작성은 개발 단계 초기에 문제 발견에 도움을 주기 때문에, 개발 시간을 단축!

스포크 프레임워크
groovy언어를 이용하여 테스트 코드를 작성할 수 있는 프레임 워크이며 junit과 비교하여 코드를 간결하게 작성 가능
그루비 언어는 동적 타입 프로그래밍 언어로 JVM위에서 작동하며 java문법과 유사

specification 클래스를 상속 받는다.
def를 이용하여 함수로 선언하며, 하나 이상 블록이 존재해야 함
—————————————————————————————————————————————

JPA이용하여 CRUD테스트 코드를 작성할 때 어떤 DB환경이 좋을까?
1. 운영환경과 유사한 스펙의 DB 사용하기
2. 인메모리 사용하기
3. Docker 이용하기
4. TestContainers를 이용하기

-testContainers는 운영환경과 유사한 DB스펙으로 독립적인 환경에서 테스트 코드를 작성하여 테스트가 가능하다.
-통합테스트가 되기 위해선 도커가 실행되고 있어야 한다.
—————————————————————————————————————————————

Spring Data JPA 사용시 주의사항
JPA의 모든 데이터 변경은 아래와 같이 트랜잭션 안에서 실행된다.

즉, 트랜잭션 밖에서 데이터 변경은 반영되지 않는다.

변경이 일어나는 코드는 @Transactional이 이미 정의 되어 있다.

영속성 컨텍스트는 entity를 저장하고 관리하는 저장소이며, 어플리케이션과 데이터베이스 사이에 엔티티를 보관하는 가상의
데이터 베이스 같은 역할

JPA에서 제공하는 sava메소드 구현 코드를 보면 em.persist를 통해 영속성 컨텍스트에 저장

이때 엔티티는 영속상태

이미 영속상태인 경우 merge를 통해 덮어 쓴다.

dirty checking이란 entity상태 변경 검사

JPA에서 트랜잭션이 끝나는 시점에 변화가 있는 모든 entity 객체를 데이터 베이스에 자동으로 반영해 준다.

—————————————————————————————————————————————
JPA Auditing이란?
@MappedSuperclass // 엔티티의 공통 매핑 정보
@EntityListener // 해당 클래스에 auditing 기능을 포함
@CreatedDate // Entity가 생성되어 저장될 때 시간이 자동 저장
@LastModifiedDate // Entity 값을 변경할 때 시간이 Update

—————————————————————————————————————————————

Spring Transactional

스프링에서 트랜잭션 처리를 @Transactional 어노테이션을 이용하여 처리
트랜잭션이 포함된 메소드가 호출될 경우, 프록시 객체를 생성함으로써 트랜잭션 생성 및 커밋 또는 롤백 후 트랜잭션 닫는
부수적인 작업을 프록시 객체에게 위임

—————————————————————————————————————————————

거리계산 알고리즘

하버사인 포뮬러 알고리즘

—————————————————————————————————————————————

spring Retry

일시적인 오류 부분에 대해서 시스템 안전성을 높이기 위해 재처리하는 방식
->우리는 외부 api를 사용하기 때문에 이를 이용해 볼 것임

-재시도를 몇 번 실행할 것인가?
-재시도 하기 전에 지연시간을 얼마나 줄 것인가?
-재시도를 모두 실패햇을 경우 어떻게 처리할 것인가?

default 재시도는 최대 3번, 재시도 딜레이는 1초

fallback - 재시도 한 것을 다 실패했을 경우
@Recover 어노테이션을 사용해서 메서드를 만들고 처리를 어떻게 할 지 정해주면된다.
—>return type을 맞춰줘야 한다.


—————————————————————————————————————————————
AWS ec2를 통한 배포
참고: https://wonyong-jang.github.io/aws/2022/06/05/AWS-EC2-Elastic-IP.html

-> 추후 헤로쿠를 통한 배포도 설정




주로 모바일 등으로 URL을 공유하고자 할 때, 긴 URL을 줄여서 제공

10진수보다 62진수(Base62) 64진수(Base64)를 사용해서 하되,
64진수에서는 “=“등은 URL예약어이기 때문에 부적절하다,

—————————————————————————————————————————————

AWS 배포 URL
